# Gaussian elimination

## Цель

На примере задачи [решения системы линейных уравнений методом Гаусса](https://en.wikipedia.org/wiki/Gaussian_elimination):
  * Изучить возможности OpenMP.
  * Изучить влияние параллелизации на производительность программы.

## Окружение

    CC:                              gcc
    CFLAGS:                          -Wall -Werror -Wpedantic -O{0..3}  -fopenmp -lgsl -lgslcblas -lm
    Time measurements:               valgrind --tool=callgrind --time-stamp=yes
    
    OS:                              Linux 4.19.80-1-MANJARO
    Architecture:                    x86_64
    CPU op-mode(s):                  32-bit, 64-bit
    Byte Order:                      Little Endian
    Address sizes:                   39 bits physical, 48 bits virtual
    CPU(s):                          8
    CPU family:                      6
    Model:                           142
    Model name:                      Intel(R) Core(TM) i5-8250U CPU @ 1.60GHz
    CPU max MHz:                     3400,0000
    CPU min MHz:                     400,0000

## Результаты экспериментов

### Компиляция с флагом `-O0`

| Размер матрицы | Последовательная, сек | GSL, сек | OpenMP, сек |
| :------------: | :-------------------: | :------: | :---------: |
|    10 x 10     |        0.3232         |  0.2155  |   0.2262    |
|    25 x 25     |        0.2059         |  0.2196  |   0.2386    |
|    50 x 50     |        0.2237         |  0.2603  |   0.3000    |
|   100 x 100    |        0.3249         |  0.3707  |   0.4205    |
|   150 x 150    |        0.7474         |  0.5256  |   0.6630    |
|   200 x 200    |        0.6324         |  0.6332  |   0.9997    |
|   250 x 250    |        0.9611         |  0.9176  |   1.5071    |
|   500 x 500    |        3.6337         |  3.4346  |   5.9020    |
|   750 x 750    |        8.9452         | 10.7764  |   14.2210   |
|  1000 x 1000   |        18.0685        | 17.7116  |   28.9935   |

### Компиляция с флагом `-O1`

| Размер матрицы | Последовательная, сек | GSL, сек | OpenMP, сек |
| :------------: | :-------------------: | :------: | :---------: |
|    10 x 10     |        0.1996         |  0.2183  |   0.2250    |
|    25 x 25     |        0.1981         |  0.2374  |   0.2280    |
|    50 x 50     |        0.2102         |  0.2391  |   0.2846    |
|   100 x 100    |        0.3274         |  0.3495  |   0.3861    |
|   150 x 150    |        0.3994         |  0.4069  |   0.4739    |
|   200 x 200    |        0.6105         |  0.6236  |   0.7785    |
|   250 x 250    |        0.9202         |  1.0324  |   0.9802    |
|   500 x 500    |        3.6577         |  3.5553  |   3.4035    |
|   750 x 750    |        8.7495         |  8.9523  |   7.5240    |
|  1000 x 1000   |        17.8133        | 17.9664  |   15.0755   |

### Компиляция с флагом `-O2`

| Размер матрицы | Последовательная, сек | GSL, сек | OpenMP, сек |
| :------------: | :-------------------: | :------: | :---------: |
|    10 x 10     |        0.2036         |  0.2371  |   0.2151    |
|    25 x 25     |        0.1968         |  0.2314  |   0.2627    |
|    50 x 50     |        0.2278         |  0.2317  |   0.2753    |
|   100 x 100    |        0.3013         |  0.3042  |   0.4008    |
|   150 x 150    |        0.4724         |  0.5012  |   0.6089    |
|   200 x 200    |        0.6480         |  0.6408  |   0.8561    |
|   250 x 250    |        0.9974         |  0.9968  |   1.1972    |
|   500 x 500    |        3.5483         |  3.6466  |   3.7558    |
|   750 x 750    |        9.0872         |  9.0275  |   8.5591    |
|  1000 x 1000   |        18.5432        | 18.5116  |   15.7319   |

### Компиляция с флагом `-O3`

| Размер матрицы | Последовательная, сек | GSL, сек | OpenMP, сек |
| :------------: | :-------------------: | :------: | :---------: |
|    10 x 10     |        0.2220         |  0.2031  |   0.2293    |
|    25 x 25     |        0.1988         |  0.2081  |   0.2410    |
|    50 x 50     |        0.2147         |  0.2385  |   0.2966    |
|   100 x 100    |        0.2837         |  0.3039  |   0.3800    |
|   150 x 150    |        0.3650         |  0.3993  |   0.5167    |
|   200 x 200    |        0.5126         |  0.5783  |   0.8087    |
|   250 x 250    |        0.7068         |  0.8259  |   0.9823    |
|   500 x 500    |        2.5143         |  3.3052  |   4.0862    |
|   750 x 750    |        5.9489         |  8.6307  |   9.8931    |
|  1000 x 1000   |        11.5128        | 17.5807  |   16.5659   |


## Применение OpenMP на 1..5 потоках

| Размер матрицы | 1 поток, сек | 2 потока, сек | 3 потока, сек | 4 потока, сек | 5 потоков, сек |
| :------------: | :----------: | :-----------: | :-----------: | :-----------: | :------------: |
|    10 x 10     |    0.2441    |    0.3898     |    0.2462     |    0.2745     |     0.4040     |
|    25 x 25     |    0.2337    |    0.3335     |    0.2203     |    0.2510     |     0.4711     |
|    50 x 50     |    0.2540    |    0.5050     |    0.2437     |    0.3174     |     1.3801     |
|   100 x 100    |    0.3424    |    0.7137     |    0.3536     |    0.4847     |     1.9326     |
|   150 x 150    |    0.4686    |    0.7137     |    0.4225     |    0.5573     |     4.4510     |
|   200 x 200    |    0.6172    |    1.0923     |    0.6487     |    0.7605     |     3.6120     |
|   250 x 250    |    0.8900    |    1.3159     |    0.9775     |    1.0833     |     7.4150     |
|   500 x 500    |    2.8699    |    3.8294     |    2.9596     |    3.8958     |    15.4834     |
|   750 x 750    |    6.9647    |    8.2641     |    6.3033     |    8.9232     |    22.9091     |
|  1000 x 1000   |   13.4865    |    15.3228    |    12.1790    |    16.0314    |    30.7387     |

![OpenMP Best Threads](https://github.com/viabzalov/spbu-se2019-autumn/blob/Abzalov_hw1/Gaussian%20elimination/pictures/OpenMP-Threads_1-5.png)

## Лучшая конфигурация

  * Последовательная - компиляция с флагом `-O3`
  * GSL - компиляция с флагом `-O3`
  * OpenMP - компиляция с флагом `-O1`, реализация на 3 потоках
  
| Размер матрицы | Последовательная, сек | GSL, сек | OpenMP, сек |
| :------------: | :-------------------: | :------: | :---------: |
|    10 x 10     |        0.2220         |  0.2031  |   0.2462    |
|    25 x 25     |        0.1988         |  0.2081  |   0.2203    |
|    50 x 50     |        0.2147         |  0.2385  |   0.2437    |
|   100 x 100    |        0.2837         |  0.3039  |   0.3536    |
|   150 x 150    |        0.3650         |  0.3993  |   0.4225    |
|   200 x 200    |        0.5126         |  0.5783  |   0.6487    |
|   250 x 250    |        0.7068         |  0.8259  |   0.9775    |
|   500 x 500    |        2.5143         |  3.3052  |   2.9596    |
|   750 x 750    |        5.9489         |  8.6307  |   6.3033    |
|  1000 x 1000   |        11.5128        | 17.5807  |   12.1790   |

![Best Implementations](https://github.com/viabzalov/spbu-se2019-autumn/blob/Abzalov_hw1/Gaussian%20elimination/pictures/Bests.png)

## Выводы

Из проделанных опытов можно сделать следующие выводы:
  * При компиляции с флагами `-O1` и `-O2` параллельная реализация работает быстрее остальных. 
  * При компиляции с флагом `-O3` производительность последовательной реализации резко увеличивается по сравнению с остальными. Это обусловлено тем, что компилятором дополнительно подключаются флаги автоматической параллелизации и векторизации.

В итоге, проделанные опыты дают возможность утверждать, что, на примере решения системы линейных уравнений методом Гаусса, параллелизация увеличивает производительность программы.
